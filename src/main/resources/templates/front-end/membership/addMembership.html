<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<meta name="viewport"
	content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>會員註冊</title>


<!-- 前台畫面header的引入文件-->
<link rel="stylesheet"
	href="https://fonts.googleapis.com/css2?family=Quicksand:wght@500&display=swap">

<!-- 引入 Bootstrap CSS 文件 -->
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
	rel="stylesheet"
	integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
	crossorigin="anonymous">
<!-- 前台畫面header的引入文件-->


<style>
main {
	min-height: calc(100vh - 70px);
	/* 設定 main 區域的最小高度，確保 footer 固定在底部 */
}

/* form {
            max-width: 400px;
            margin: 0 auto;
        } */
/*調整框框長度用*/
.form-group {
	margin-bottom: 20px;
}

.controls-float .form-control {
	transition: all 0.3s;
	padding: 0.5rem 0rem;
	width: 50%;
	font-size: 14px;
	border: none;
	border-bottom: 1px solid #DEDEDE;
	height: 40x;
	font-size: 18px;
}

ul {
	list-style-type: none;
	padding: 0;
	margin: 0;
}

#memBirthdate {
	/* 	border: 2px solid red; */
	margin-left: -420px; /* 负值表示向左移动 */
}

#memPic {
	/* 	border: 2px solid red; */
	margin-left: -240px; /* 负值表示向左移动 */
}

p {
	margin-left: -480px;
	font-size: 18px;
}

#submit {
	border: 1px solid black;
	color: black;
	padding: 10px 10px;
	border-radius: 4px;
	cursor: pointer;
	font-size: 16px;
	width: 50%;
	background-color: white; /* 新增這一行，設定背景為白色 */
}

#submit:hover {
	border: 1px solid #CFDFEF;
	background-color: #CFDFEF;
}

p.text-center {
	margin-left: 20px;
}

a {
	color: black;
	font-size: 18px;
}

a#loginSection {
	text-decoration: none;
	font-size: 23px;
	font-weight: normal; /* 初始字体粗细 */
}

a#loginSection:hover, a#loginSection:active {
	text-decoration: underline; /* 鼠标悬停或点击时显示底线 */
	font-weight: bold; /* 鼠标悬停或点击时加粗字体 */
}

a#signupSection {
	text-decoration: none;
	font-size: 23px;
	font-weight: normal; /* 初始字体粗细 */
}

a#signupSection:hover, a#signupSection:active {
	text-decoration: underline; /* 鼠标悬停或点击时显示底线 */
	font-weight: bold; /* 鼠标悬停或点击时加粗字体 */
}

input#registerMemBirthdate {
	margin-left: -430px;
}

input#registerMemPic {
	margin-left: -290px;
}

h6#memBirthdate {
	margin-left: -460px;
}

h6#memPic {
	margin-left: -500px;
}

</style>

<style>
.error-message {
	color: red;
	font-size: 16px;
	display: none;
}

.error {
	margin-left: -50px;
	color: red;
	font-size: 16px;
}

#memAcc-error2 {
	color: red;
}

#memEmail-error2 {
	color: red;
}
</style>
</head>

<body>


	<div class="container">
		<header
			class="d-flex flex-wrap align-items-center justify-content-center justify-content-md-between py-3 mb-4 border-bottom">
			<div class="col-md-3 mb-2 mb-md-0">
				<a href='select_page'
					class="d-inline-flex link-body-emphasis text-decoration-none">
					<span class="fs-4"><img alt="ZuoHuo" src="/front-end/16/images/ZuoHuo4.jpg" width="160px" ></span>
				</a>
			</div>


			<ul
				class="nav col-12 col-md-auto mb-2 justify-content-center mb-md-0">
				<li><a th:href="@{/membership/ZuoHuo}" class="nav-link px-2 link-secondary">首頁</a></li>
				<li><a href="join.html" class="nav-link px-2 link-secondary">瀏覽活動</a></li>
				<li><a href="create.html" class="nav-link px-2 link-secondary">舉辦活動</a></li>
				<li><a href="rent.html" class="nav-link px-2 link-secondary">場地租借</a></li>
				<li><a th:href="@{/faq/faqs}" 
					class="nav-link px-2 link-secondary">FAQs</a></li>
				<li><a th:href="@{/faq/faqs}"  class="nav-link px-2 link-secondary">關於我們</a></li>
			</ul>

			<div class="col-md-3 text-end">
				<button type="button" class="btn btn-primary">
					<a class="nav-link" href='login'>登入</a>
				</button>
				<button type="button" class="btn btn-primary">
					<a class="nav-link" href='addMembership'>註冊</a>
				</button>
			</div>
		</header>
	</div>


	<!-- -------------------------------------------------------------------------------------- -->

	<main class="container mt-5">

		<div align="center">


			<!-- 加入會員超链接 -->
			<a id="signupSection" href='addMembership'>加入會員</a>

			<!-- 登入超链接 -->
			<a id="loginSection" href='login'>會員登入</a>


			<!-- 其他内容 -->

			<!-- 加入會員部分 -->
			<div id="signupSection">
				<!-- 加入會員表单等内容 -->
			</div>

			<!-- 登入部分 -->
			<div id="loginSection">
				<!-- 登入表单等内容 -->
			</div>



			<form id="yourFormId" th:action="@{insert}" method="post"
				th:object="${membershipVO}" enctype="multipart/form-data">

				<ul>

					<li class="controls-float"><label class="title"
						for="registerMemAcc"></label> <input class="form-control text"
						id="registerMemAcc" type="text" placeholder="會員帳號(必填)"
						autocomplete="off" name="memAcc" /> <span class="error-message"
						id="memAcc-error"></span><span id="memAcc-error2"></span></li>

					<li class="controls-float"><label class="title"
						for="registerMemEmail"></label><input class="form-control text"
						id="registerMemEmail" type="text" placeholder="電子信箱(必填)"
						autocomplete="off" name="memEmail" /> <span class="error-message"
						id="memEmail-error"></span><span id="memEmail-error2"></span></li>
					
					<li class="controls-float"><label class="title"
						for="registerMemPwd"></label> <input class="form-control text"
						id="registerMemPwd" type="password" placeholder="會員密碼(必填)"
						autocomplete="current-password" name="memPwd" /> <span
						class="error-message" id="memPwd-error"></span></li>


					<li class="controls-float"><label class="title"
						for="registerMemName"></label> <input class="form-control text"
						id="registerMemName" type="text" placeholder="姓名(必填)"
						autocomplete="off" name="memName" /><span class="error-message"
						id="memName-error"></span></li>

					<li class="controls-float"><label class="title"
						for="registerMemUsername"></label> <input
						class="form-control text" id="registerMemUsername" type="text"
						placeholder="使用者名稱(必填)" autocomplete="off" name="memUsername" /><span
						class="error-message" id="memUsername-error"></span></li>

					<li class="controls-float"><label class="title"
						for="registerMemPhone"></label> <input class="form-control text"
						id="registerMemPhone" type="text" placeholder="手機號碼"
						autocomplete="off" name="memPhone" /> <span class="error-message"
						id="memPhone-error"></span></li>

					<li class="controls-float"><label class="title"
						for="registerMemIntro"></label> <input class="form-control text"
						id="registerMemIntro" type="text" placeholder="自我介紹"
						autocomplete="off" name="memIntro" /></li>

					<li class="controls-float"><label class="title"
						for="registerMemGender"></label> <select class="form-control"
						id="registerMemGender" name="memGender">
							<option value="1">性別(必填) :女</option>
							<option value="2">性別(必填) :男</option>
					</select> <span class="error-message" id="memGender-error"></span></li>

					<br>

					<h6 id="memBirthdate">會員生日(必填)</h6>
					<li class="controls-float"><label class="title"
						for="registerMemBirthdate"></label> <input type="date"
						id="registerMemBirthdate" th:field="*{memBirthdate}" /> <span
						class="error" th:if="${#fields.hasErrors('memBirthdate')}"
						th:errors="*{memBirthdate}" id="memBirthdate-errors"></span><br>
						<span class="error-message" id="memBirthdate-error"></li>
					<br>

					<h6 id="memPic">會員圖片</h6>
					<li class="controls-float"><label class="title"
						for="registerMemPic"></label><input type="file"
						id="registerMemPic" th:field="*{memPic}" onclick="previewImage()"
						multiple="multiple" /> <span class="error"
						th:utext="${errorMessage}" id="memPic.errors"></span> <br> <span
						class="error-message" id="memPic-error"></span>
						<div id="blob_holder"></div></li>

				</ul>


				<div>
					<br>
					<button type="submit" id="submit">註冊會員</button>
				</div>
			</form>
		</div>
	</main>

	<!-- -------------------------------------------------------------------------------------- -->

	<div class="container">
		<footer class="py-3 my-4">
			<ul class="nav justify-content-center border-bottom pb-3 mb-3">
				<li class="nav-item"><a href="index.html"
					class="nav-link px-2 text-muted">首頁</a></li>
				<li class="nav-item"><a href="customer.html"
					class="nav-link px-2 text-muted">客服中心</a></li>
				<li class="nav-item"><a href="about.html"
					class="nav-link px-2 text-muted">關於我們</a></li>
			</ul>
			<p class="text-center text-muted">© 2023 Company, Inc</p>
		</footer>
	</div>

	<!-- 登入選項的Modal 彈窗 -->
	<!-- 	<div class="modal fade" id="loginModal" tabindex="-1" -->
	<!-- 		aria-labelledby="loginModalLabel" aria-hidden="true"> -->
	<!-- 		<div class="modal-dialog"> -->
	<!-- 			<div class="modal-content"> -->
	<!-- 				<div class="modal-header"> -->
	<!-- 					<h5 class="modal-title" id="loginModalLabel">會員登入</h5> -->
	<!-- 					<button type="button" class="btn-close" data-bs-dismiss="modal" -->
	<!-- 						aria-label="Close"></button> -->
	<!-- 				</div> -->
	<!-- 				<div class="modal-body"> -->
	<!-- 					在這裡加入登入表單的 HTML 代碼 -->
	<!-- 					<form> -->
	<!-- 						登入表單的輸入欄位 -->
	<!-- 						<div class="mb-3"> -->
	<!-- 							<label for="username" class="form-label">帳號：</label> <input -->
	<!-- 								type="text" class="form-control" id="username" name="username" -->
	<!-- 								placeholder="輸入您的帳號" required> -->
	<!-- 						</div> -->
	<!-- 						<div class="mb-3"> -->
	<!-- 							<label for="password" class="form-label">密碼：</label> -->
	<!-- 							<div class="input-group"> -->
	<!-- 								<input type="password" class="form-control" id="password" -->
	<!-- 									name="password" placeholder="輸入您的密碼" required> -->
	<!-- 								在密碼輸入框右上方新增"忘記密碼"的連結 -->
	<!-- 								<a href="#" class="input-group-text" id="forgotPasswordLink">忘記密碼</a> -->
	<!-- 							</div> -->
	<!-- 						</div> -->
	<!-- 						登入按鈕 -->
	<!-- 						<button type="submit" class="btn btn-primary">登入</button> -->
	<!-- 					</form> -->

	<!-- 				</div> -->
	<!-- 			</div> -->
	<!-- 		</div> -->
	<!-- 	</div> -->



	<!-- -----------------------------引入文件----------------------------------- -->
	<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
	<!-- -----------------------------引入文件----------------------------------- -->

	<!-- -----------------------------前台畫面引入文件----------------------------------- -->
	<!-- 引入 Bootstrap JavaScript 文件 -->
	<script
		src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
		integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
		crossorigin="anonymous"></script>

	<!-- -----------------------------前台畫面引入文件----------------------------------- -->


	<!-- JavaScript part -->
	<script type="text/javascript">
		//清除提示信息
		function hideContent(d) {
			document.getElementById(d).style.display = "none";
		}

		//照片上傳-預覽用
		var filereader_support = typeof FileReader != 'undefined';
		if (!filereader_support) {
			alert("No FileReader support");
		}
		acceptedTypes = {
			'image/png' : true,
			'image/jpeg' : true,
			'image/gif' : true
		};
		function previewImage() {

			var upfile1 = document.getElementById("registerMemPic");
			upfile1.addEventListener("change", function(event) {
				var files = event.target.files || event.dataTransfer.files;
				for (var i = 0; i < files.length; i++) {
					previewfile(files[i]);
				}
			}, false);

		}
		function previewfile(file) {
			if (filereader_support === true
					&& acceptedTypes[file.type] === true) {
				var reader = new FileReader();
				reader.onload = function(event) {
					var image = new Image();
					image.src = event.target.result;
					image.width = 180;
// 					image.height =180;
					image.border = 0;
					if (blob_holder.hasChildNodes()) {
						blob_holder.removeChild(blob_holder.childNodes[0]);
					}
					blob_holder.appendChild(image);
				};
				reader.readAsDataURL(file);
				document.getElementById('submit').disabled = false;
			} else {
				blob_holder.innerHTML = "<div  style='text-align: left;'>"
						+ "● filename: "
						+ file.name
						+ "<br>"
						+ "● ContentTyp: "
						+ file.type
						+ "<br>"
						+ "● size: "
						+ file.size
						+ "bytes"
						+ "<br>"
						+ "● 上傳ContentType限制: <b> <font color=red>image/png、image/jpeg、image/gif </font></b></div>";
				document.getElementById('submit').disabled = true;
			}
		}

		<!-- JavaScript part -->
		
		
		
		// --------------------- 以下為memAcc帳號的判斷------------------------

		$(document).ready(function() {
			$("#registerMemAcc").on("input", function() {
				var memAcc = $(this).val();
				if (memAcc.length < 5) {
					$("#memAcc-error").text("帳號長度至少為5個字").show();
				} else {
					$("#memAcc-error").hide();
				}
			});
		});
		
       // ------------------------------------------------------
		$(document).ready(function() {
			$("#yourFormId").submit(function() {
				var memAcc = $("#registerMemAcc").val();
				if (memAcc.length < 1) {
					$("#memAcc-error").text("請輸入帳號").show();
					return false; // 阻止表單提交
				} else {
					$("#memAcc-error").hide();
					return true; // 允許表單提交
				}
			});
		});
		
		// ------------------------------------------------------
		$(document).ready(function() {
			// 輸入框綁定input事件，當輸入產生變化時檢查
		    $("#registerMemAcc").on("input", function() {
		        checkMemAcc();
		    });
		});

		function checkMemAcc() {
		    var memAcc = $("#registerMemAcc").val();

		    fetch("/membership/checkMemAcc",{
		    	   method: "POST",
		    	   body: JSON.stringify({memAcc: memAcc})  //回傳的為body標籤  　key(VO對應)　：　輸入的值
		    	  }).then(function(response){;
		    	   return response.json();
		    	  }).then(function(result){
		    		  		 
		    	
		    	   if(result != null){ 

				    $("#memAcc-error2").text("此帳號已使用過").show();
				    $("#memAcc-error2").data("show", true);			    	    

				    // 清除之前的提交阻止
				    $("#yourFormId").off("submit");
				    	    	
				    } else{
				    $("#memAcc-error2").hide(); 
				    $("#memAcc-error2").data("show", false);
				    	    	
				    // 允許表單提交
				    $("#yourFormId").off("submit").submit();
				    
				    } 
				   }).catch(function(err){
				    $("#memAcc-error2").hide(); 
				    $("#memAcc-error2").data("show", false);
				  });
				}
	  
		    		  
// 		    	   if(result != null){ 

// 		    	    $("#memAcc-error2").text("此帳號已使用過").show();
// 		    	    $("#memAcc-error2").data("show", true);
		    	    
// 		    	    	$("#yourFormId").submit(function(){    /////////******* 禁止提交表單
// 		    	    		return false;
// 		    	    	});
		    	    	
// 		    	   } else{
// 		    	    $("#memAcc-error2").hide(); 
// 		    	    $("#memAcc-error2").data("show", false);
		    
// 		    	   } 
// 		    	  }).catch(function(err){
// 		    	   $("#memAcc-error2").hide(); 
// 		    	   $("#memAcc-error2").data("show", false);
// 		    	  });
// 		}
		
		
		// ----------------------- 以下為memEmail帳號的判斷----------------------------
		$(document).ready(function() {
			$("#registerMemEmail").on("input", function() {
				var memEmail = $(this).val();
				var emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

				if (!emailRegex.test(memEmail)) {
					$("#memEmail-error").text("請輸入有效的電子郵件地址").show();
				} else {
					$("#memEmail-error").hide();
				}
			});
		});

		// ------------------------------------------------------
		$(document).ready(function() {
			$("#yourFormId").submit(function() {
				var memAcc = $("#registerMemEmail").val();
				if (memAcc.length < 1) {
					$("#memEmail-error").text("請輸入信箱").show();
					return false; // 阻止表單提交
				} else {
					$("#memEmail-error").hide();
					return true; // 允許表單提交
				}
			});
		});
		
		// ------------------------------------------------------	
		$(document).ready(function() {
		    // 輸入框綁定input事件，當輸入產生變化時檢查
		    $("#registerMemEmail").on("input", function() {
		        checkMemEmail();
		    });
		});
		
		function checkMemEmail() {
		    var memEmail = $("#registerMemEmail").val();

		    fetch("/membership/checkMemEmail",{
		    	   method: "POST",
		    	   body: JSON.stringify({memEmail: memEmail})  //回傳的為body標籤   key(VO對應)　：　輸入的值
		    	  }).then(function(response){;
		    	   return response.json();
		    	  }).then(function(result){
		    		  		    		   
		    	 		if(result != null){     //如果result != null，信箱使用過，不允許提交表單
		    	 								//如果result == null，信箱未使用過，允許表單提交

		       	    $("#memEmail-error2").text("此信箱已使用過").show();
		       	    $("#memEmail-error2").data("show", true);
		       	    
		       	    //清除之前的提交阻止
		       	    $("#yourFormId").off("submit");
		       	    
		       	   } else{
		       	    $("#memEmail-error2").hide(); 
		       	    $("#memEmail-error2").data("show", false);
		       	    
		       	    //允許表單提交
		       	    $("#yourFormId").off("submit").submit();
		       	    
		       	   } 
		       	  }).catch(function(err){
		       	   $("#memEmail-error2").hide(); 
		       	   $("#memEmail-error2").data("show", false);
		       	  });
		}
		
				
		// ----------------------- 以下為memPwd密碼的判斷------------------------------
		$(document).ready(function() {
			$("#registerMemPwd").on("input", function() {
				var memPwd = $(this).val();
				if (memPwd.length < 8) {
					$("#memPwd-error").text("密碼長度至少為8個字").show();
				} else {
					$("#memPwd-error").hide();
				}
			});
		});
		
		// ------------------------------------------------------
		$(document).ready(function() {
			$("#yourFormId").submit(function() {
				var memPwd = $("#registerMemPwd").val();
				if (memPwd.length < 1) {
					$("#memPwd-error").text("請輸入密碼").show();
					return false; //阻止表單提交
				} else {
					$("#memPwd-error").hide();
					return true; //允許表單提交
				}
			});

		});


		// ----------------------- 以下為memPhone手機號碼的判斷------------------------------
		$(document).ready(function() {
			$("#registerMemPhone").on("input", function() {
				var memPhone = $(this).val();

				// 使用正規法判斷是否為數字且不超過10字
				var validPhone = /^\d{1,10}$/;
				if (!validPhone.test(memPhone)) {
					$("#memPhone-error").text("請輸入正確格式的手機號碼").show();
				} else {
					$("#memPhone-error").hide();
				}
			});
		});
		
		
		
		// ----------------------- 以下為memName姓名的判斷------------------------------
	$(document).ready(function(){
    $("#registerMemName").on("input", function(){
        var memName = $(this).val();
        
        // 使用正規表示法，判斷是否只包含中文字
        var validNameRegex = /^[\u4E00-\u9FA5]+$/;
        
        if (!validNameRegex.test(memName)) {
            // 如果輸入的名字包含非中文字，顯示錯誤訊息
            $("#memName-error").text("請輸入中文字").show();
        } else {
            // 隱藏錯誤訊息
            $("#memName-error").hide();
        }
    });
});


		// --------------------------------------------------------------
		
		$(document).ready(function() {
    // 輸入框時檢查
    $("#registerMemName").on("input", function() {
        var memName = $(this).val();
        if (memName.length >= 1) {
            $("#memName-error").hide();
        }
    });

    // 表單提交時間檢查
    $("#yourFormId").submit(function() {
        var memName = $("#registerMemName").val();
        if (memName.length < 1) {
            $("#memName-error").text("請輸入姓名").show();
            return false; // 阻止表單提交
        } else {
            $("#memName-error").hide();
            return true; // 允許表單提交
        }
    });
});

		// --------------------- 以下為memUsername使用者姓名的判斷------------------------
		$(document).ready(function(){
			$("#registerMemUsername").on("input", function () {
				var memUsername = $(this).val();
				if(memUsername.length >= 1){
					$("#memUsername-error").hide();
				}
			});
		});
		
		$(document).ready(function() {
			$("#yourFormId").submit(function() {
// 				alert("submit");
				var memUsername = $("#registerMemUsername").val();
				if (memUsername.length < 1) {
					$("#memUsername-error").text("請輸入使用者名稱").show();
					return false; //阻止表單提交
				} else {
					$("#memUsername-error").hide();
					return true; //允許表單提交
				}
			});

		});
		
		// --------------------- 以下為memBirthdate生日的判斷------------------------
		
		$(document).ready(function () {
		    // 提交表單時的處理
		    $("#yourFormId").submit(function () {
		        var memBirthdate = $("#registerMemBirthdate").val();
		        if (memBirthdate === "") {
		            $("#memBirthdate-error").text("請選擇出生日期").show();
		            return false; // 阻止提交表單
		        } else {
		            $("#memBirthdate-error").hide();
		            return true; // 允許表單提交
		        }
		    });

		    // 生日更改時的處理
		    $("#registerMemBirthdate").change(function () {
		        $("#memBirthdate-error").hide(); // 隱藏錯誤訊息
		    });
		});
		
		
		
	</script>

</body>

</html>

